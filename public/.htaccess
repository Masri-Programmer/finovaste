<IfModule mod_rewrite.c>
    Options -MultiViews -Indexes
    RewriteEngine On

    # Set the base path
    RewriteBase /

    # Handle Authorization Header
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    # Redirect Trailing Slashes
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} (.+)/$
    RewriteRule ^ %1 [L,R=301]
    RewriteCond %{HTTP_HOST} ^https://www\.masri-programmer\.de [NC]
    RewriteRule ^(.*)$ https://masri-programmer.de/$1 [L,R=301]
    # Handle Front Controller...
    # Only run the rule if this is the initial request (prevents loop)
    RewriteCond %{ENV:REDIRECT_STATUS} ^$
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule .* /index.php [L]

  ExpiresActive On

  # --- DYNAMIC CONTENT ---
  ExpiresByType text/html               "access plus 10 minutes"
  ExpiresByType application/xml         "access plus 10 minutes"
  ExpiresByType application/json        "access plus 10 minutes"

  # --- STATIC CONTENT (IMAGES, CSS, JS) ---
  ExpiresByType image/jpeg              "access plus 1 year"
  ExpiresByType image/png               "access plus 1 year"
  ExpiresByType image/gif               "access plus 1 year"
  ExpiresByType image/webp              "access plus 1 year"
  ExpiresByType image/svg+xml           "access plus 1 year"
  ExpiresByType image/x-icon            "access plus 1 year"

  ExpiresByType text/css                "access plus 1 month"
  ExpiresByType application/javascript  "access plus 1 month"

  # --- OTHER ---
  # Fonts
  ExpiresByType application/font-woff   "access plus 1 year"
  ExpiresByType application/font-woff2  "access plus 1 year"
  ExpiresByType application/vnd.ms-fontobject "access plus 1 year"
  ExpiresByType application/x-font-ttf  "access plus 1 year"

  # Videos
  ExpiresByType video/mp4               "access plus 1 year"
  ExpiresByType video/webm              "access plus 1 year"

  # --- DEFAULT ---
  ExpiresDefault "access plus 1 day"
</IfModule>
